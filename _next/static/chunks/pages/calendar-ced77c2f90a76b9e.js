(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[844],{1442:function(e,i,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/calendar",function(){return a(6442)}])},6442:function(e,i,a){"use strict";a.r(i),a.d(i,{default:function(){return y}});var c=a(5893),n=a(7294),o=a(6564),t=a(3907),r=a(1132),s=a(9897),l=a(498),d=a(2655),h=a(1140),u=a(791),x=a(5654),m=a(2175),v=a(4231),f=function(e){let i=[{text:"Sin Repetici\xf3n",value:"no"},{text:"Diario",value:"dia"},{text:"Semanal",value:"semana"},{text:"Mensual",value:"mes"},{text:"Anual",value:"anio"}],a={repeticion:"",fechaInicio:"",fechaFin:"",horaInicio:"",horaFin:"",titulo:"",descripcion:""},n=async i=>{let a={repeticion:i["0"].value,titulo:i["1"].value,fechaInicio:"".concat(i["2"].value," ").concat(i["4"].value,":00"),fechaFin:"".concat(i["3"].value," ").concat(i["5"].value,":00"),descripcion:i["6"].value};await e.submit(a),e.toggle()};return(0,c.jsxs)(o.u_,{isOpen:e.show,toggle:e.toggle,size:"xl",children:[(0,c.jsx)(o.xB,{toggle:e.toggle,children:"Agregar Evento"}),(0,c.jsx)(o.fe,{children:(0,c.jsx)(m.J9,{initialValues:{repeticion:a.repeticion,fechaInicio:a.fechaInicio,fechaFin:a.fechaFin,horaInicio:a.horaInicio,horaFin:a.horaFin,titulo:a.titulo,descripcion:a.descripcion},validationSchema:v.Ry().shape({repeticion:v.Z_(),fechaInicio:v.Z_().required("Es requerido..!"),fechaFin:v.Z_().required("Es requerido..!"),horaInicio:v.Z_().required("Es requerido..!"),horaFin:v.Z_().required("Es requerido..!"),titulo:v.Z_().required("Es requerido..!"),descripcion:v.Z_().required("Es requerido...!")}),children(e){let{errors:a,touched:t}=e;return(0,c.jsxs)(o.l0,{async onSubmit(e){e.preventDefault();let i=Boolean(Object.keys(a).length);i||await n(e.target)},children:[(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"repeticion",children:[(0,c.jsx)(l.Z,{size:20})," ","Periodicidad"]}),(0,c.jsx)(m.gN,{as:"select",name:"repeticion",className:"form-control ".concat(a.repeticion&&t.repeticion?"is-invalid":""),id:"repeticion",children:i.map((e,i)=>(0,c.jsx)("option",{value:e.value,children:e.text},i))}),a.repeticion&&t.repeticion&&(0,c.jsx)("div",{className:"text-danger ms-4",children:a.repeticion})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"titulo",children:[(0,c.jsx)(d.Z,{size:20}),"  ","T\xedtulo"]}),(0,c.jsx)(m.gN,{type:"text",name:"titulo",className:"form-control ".concat(a.fechaInicio&&t.fechaInicio?"is-invalid":""),placeholder:"t\xedtulo",id:"titulo"}),a.titulo&&t.titulo&&(0,c.jsx)("div",{className:"text-danger ms-4",children:a.titulo})]})})]}),(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"fechaInicio",children:[(0,c.jsx)(h.Z,{size:20}),"  ","Fecha de Inicio"]}),(0,c.jsx)(m.gN,{type:"date",name:"fechaInicio",className:"form-control ".concat(a.fechaInicio&&t.fechaInicio?"is-invalid":""),placeholder:"fecha de inicio",id:"fechaInicio"}),a.fechaInicio&&t.fechaInicio&&(0,c.jsx)("div",{className:"text-danger ms-4",children:a.fechaInicio})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"fechaFin",children:[(0,c.jsx)(h.Z,{size:20}),"  ","Fecha Fin"]}),(0,c.jsx)(m.gN,{type:"date",name:"fechaFin",className:"form-control ".concat(a.fechaFin&&t.fechaFin?"is-invalid":""),placeholder:"fecha de final",id:"fechaFin"}),a.fechaFin&&t.fechaFin&&(0,c.jsx)("div",{className:"text-danger ms-4",children:a.fechaFin})]})})]}),(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"horaInicio",children:[(0,c.jsx)(u.Z,{size:20}),"  ","Hora de Inicio"]}),(0,c.jsx)(m.gN,{type:"time",name:"horaInicio",className:"form-control ".concat(a.fechaFin&&t.fechaFin?"is-invalid":""),placeholder:"hora de inicio",id:"horaInicio"}),a.horaInicio&&t.horaInicio&&(0,c.jsx)("div",{className:"text-danger ms-4",children:a.horaInicio})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"horaFin",children:[(0,c.jsx)(u.Z,{size:20}),"  ","Hora Fin"]}),(0,c.jsx)(m.gN,{type:"time",name:"horaFin",className:"form-control ".concat(a.horaFin&&t.horaFin?"is-invalid":""),placeholder:"hora de inicio",id:"horaFin"}),a.horaFin&&t.horaFin&&(0,c.jsx)("div",{className:"text-danger ms-4",children:a.horaFin})]})})]}),(0,c.jsx)("div",{className:"row",children:(0,c.jsx)("div",{className:"col-md-12",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"descripcion",children:[(0,c.jsx)(x.Z,{size:20}),"  ","Descripci\xf3n"]}),(0,c.jsx)(m.gN,{as:"textarea",name:"descripcion",className:"form-control ".concat(a.descripcion&&t.descripcion?"is-invalid":""),placeholder:"descripci\xf3n",id:"descripcion"}),a.descripcion&&t.descripcion&&(0,c.jsx)("div",{className:"text-danger ms-4",children:a.descripcion})]})})}),(0,c.jsxs)("div",{className:"row d-flex justify-content-end pt-5",children:[(0,c.jsx)(o.zx,{color:"primary",disabled:Boolean(Object.keys(a).length),type:"submit",children:"Crear Evento"})," "]})]})}})})]})},p=a(6154),j=a(2920);a(4213);let g="http://3.145.150.44:4011/eventos/";var N={async newEvent(e){let{token:i,data:a}=e;try{let c=await p.Z.post("".concat(g,"nuevoEvento"),a,{headers:{authorization:"Bearer ".concat(i)}});return c}catch(n){console.log(n),j.Am.error("\xa1Ha ocurrido un error, acci\xf3n abortada!",{position:j.Am.POSITION.TOP_RIGHT})}},async getEvents(e){try{let i=await p.Z.get("".concat(g,"listarEventos"),{headers:{authorization:"Bearer ".concat(e)}});return i}catch(a){console.log(a),j.Am.error("\xa1Ha ocurrido un error!",{position:j.Am.POSITION.TOP_RIGHT})}},async editEvent(e){let{token:i,data:a}=e;try{let c=await p.Z.post("".concat(g,"actualizarEvento"),a,{headers:{authorization:"Bearer ".concat(i)}});return c}catch(n){console.log(n),j.Am.error("\xa1Ha ocurrido un error, acci\xf3n abortada!",{position:j.Am.POSITION.TOP_RIGHT})}},async deleteEvent(e){let{token:i,idEvento:a}=e;try{let c=await p.Z.post("".concat(g,"eliminarEvento"),{idEvento:a},{headers:{authorization:"Bearer ".concat(i)}});return c}catch(n){console.log(n),j.Am.error("\xa1Ha ocurrido un error, acci\xf3n abortada!",{position:j.Am.POSITION.TOP_RIGHT})}}},I=function(e){var i,a,n,t,r,s;let l=async i=>{var a;let c={titulo:i["0"].value,fechaInicio:"".concat(i["1"].value," ").concat(i["3"].value,":00"),fechaFinal:"".concat(i["2"].value," ").concat(i["4"].value,":00"),descripcion:i["5"].value,idEvento:null===(a=e.event)||void 0===a?void 0:a.id};await e.submit(c),e.toggle()};return(0,c.jsxs)(o.u_,{isOpen:e.show,toggle:e.toggle,size:"xl",children:[(0,c.jsx)(o.xB,{toggle:e.toggle,children:"Editar Evento"}),(0,c.jsx)(o.fe,{children:(0,c.jsx)(m.J9,{initialValues:{fechaInicio:null===(i=e.event)||void 0===i?void 0:i.fechaInicio,fechaFin:null===(a=e.event)||void 0===a?void 0:a.fechaFin,horaInicio:null===(n=e.event)||void 0===n?void 0:n.horaInicio,horaFin:null===(t=e.event)||void 0===t?void 0:t.horaFin,titulo:null===(r=e.event)||void 0===r?void 0:r.titulo,descripcion:null===(s=e.event)||void 0===s?void 0:s.descripcion},validationSchema:v.Ry().shape({fechaInicio:v.Z_().required("Es requerido..!"),fechaFin:v.Z_().required("Es requerido..!"),horaInicio:v.Z_().required("Es requerido..!"),horaFin:v.Z_().required("Es requerido..!"),titulo:v.Z_().required("Es requerido..!"),descripcion:v.Z_().required("Es requerido...!")}),children(e){let{errors:i,touched:a}=e;return(0,c.jsxs)(o.l0,{async onSubmit(e){e.preventDefault();let a=Boolean(Object.keys(i).length);a||await l(e.target)},children:[(0,c.jsx)("div",{className:"row",children:(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"titulo",children:[(0,c.jsx)(d.Z,{size:20}),"  ","T\xedtulo"]}),(0,c.jsx)(m.gN,{type:"text",name:"titulo",className:"form-control ".concat(i.fechaInicio&&a.fechaInicio?"is-invalid":""),placeholder:"t\xedtulo",id:"titulo"}),i.titulo&&a.titulo&&(0,c.jsx)("div",{className:"text-danger ms-4",children:i.titulo})]})})}),(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"fechaInicio",children:[(0,c.jsx)(h.Z,{size:20}),"  ","Fecha de Inicio"]}),(0,c.jsx)(m.gN,{type:"date",name:"fechaInicio",className:"form-control ".concat(i.fechaInicio&&a.fechaInicio?"is-invalid":""),placeholder:"fecha de inicio",id:"fechaInicio"}),i.fechaInicio&&a.fechaInicio&&(0,c.jsx)("div",{className:"text-danger ms-4",children:i.fechaInicio})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"fechaFin",children:[(0,c.jsx)(h.Z,{size:20}),"  ","Fecha Fin"]}),(0,c.jsx)(m.gN,{type:"date",name:"fechaFin",className:"form-control ".concat(i.fechaFin&&a.fechaFin?"is-invalid":""),placeholder:"fecha de final",id:"fechaFin"}),i.fechaFin&&a.fechaFin&&(0,c.jsx)("div",{className:"text-danger ms-4",children:i.fechaFin})]})})]}),(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"horaInicio",children:[(0,c.jsx)(u.Z,{size:20}),"  ","Hora de Inicio"]}),(0,c.jsx)(m.gN,{type:"time",name:"horaInicio",className:"form-control ".concat(i.fechaFin&&a.fechaFin?"is-invalid":""),placeholder:"hora de inicio",id:"horaInicio"}),i.horaInicio&&a.horaInicio&&(0,c.jsx)("div",{className:"text-danger ms-4",children:i.horaInicio})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"horaFin",children:[(0,c.jsx)(u.Z,{size:20}),"  ","Hora Fin"]}),(0,c.jsx)(m.gN,{type:"time",name:"horaFin",className:"form-control ".concat(i.horaFin&&a.horaFin?"is-invalid":""),placeholder:"hora de inicio",id:"horaFin"}),i.horaFin&&a.horaFin&&(0,c.jsx)("div",{className:"text-danger ms-4",children:i.horaFin})]})})]}),(0,c.jsx)("div",{className:"row",children:(0,c.jsx)("div",{className:"col-md-12",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)(o.__,{for:"descripcion",children:[(0,c.jsx)(x.Z,{size:20}),"  ","Descripci\xf3n"]}),(0,c.jsx)(m.gN,{as:"textarea",name:"descripcion",className:"form-control ".concat(i.descripcion&&a.descripcion?"is-invalid":""),placeholder:"descripci\xf3n",id:"descripcion"}),i.descripcion&&a.descripcion&&(0,c.jsx)("div",{className:"text-danger ms-4",children:i.descripcion})]})})}),(0,c.jsxs)("div",{className:"row d-flex justify-content-end pt-5",children:[(0,c.jsx)(o.zx,{color:"primary",disabled:Boolean(Object.keys(i).length),type:"submit",children:"Editar Evento"})," "]})]})}})})]})},F=a(6455),_=a.n(F);let E=()=>{let[e,i]=(0,n.useState)(!1),[a,l]=(0,n.useState)(!1),[d,h]=(0,n.useState)(),[u,x]=(0,n.useState)([]),[m,v]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("usuario"));console.log(e),void 0!=e&&(h(e.accessToken),p(e.accessToken))},[]);let p=async e=>{try{let i=await N.getEvents(e||d),a=[];if(i.data.eventos.length){for(let c=0;c<i.data.eventos.length;c++){let n=i.data.eventos[c];a.push({index:c,id:n.pk_eve,title:n.nombreEvento,start:Date.parse(n.fechaHora_i),end:Date.parse(n.fechaHora_f),description:n.descripcion})}console.log(a)}x(a)}catch(o){console.log(o)}},g=async e=>{let i=await N.newEvent({token:d,data:e});console.log(i),await p(d)},F=async e=>{let i=await N.editEvent({token:d,data:e});console.log(i),await p(d)},E=()=>{if(!m)return j.Am.error("\xa1Selecciona un evento primero!",{position:j.Am.POSITION.TOP_RIGHT});l(!0)},y=async()=>{if(!m)return j.Am.error("\xa1Selecciona un evento primero!",{position:j.Am.POSITION.TOP_RIGHT});let e=await _().fire({title:"\xbfEst\xe1 seguro de borrar ".concat(m.titulo,"?"),confirmButtonText:"Si",showCancelButton:!0,cancelButtonText:"No",icon:"warning"});e.value&&Z()},w=e=>{let i=e.event,a=i._def,c={titulo:i.title,fechaInicio:"".concat(i.start.getFullYear(),"-").concat(i.start.getMonth()+1<10?"0":"").concat(i.start.getMonth()+1,"-").concat(10>i.start.getDate()?"0":"").concat(i.start.getDate()),fechaFin:"".concat(i.end.getFullYear(),"-").concat(i.end.getMonth()+1<10?"0":"").concat(i.end.getMonth()+1,"-").concat(10>i.end.getDate()?"0":"").concat(i.end.getDate()),horaInicio:"".concat(10>i.start.getHours()?"0":"").concat(i.start.getHours(),":").concat(10>i.start.getMinutes()?"0":"").concat(i.start.getMinutes()),horaFin:"".concat(10>i.end.getHours()?"0":"").concat(i.end.getHours(),":").concat(10>i.end.getMinutes()?"0":"").concat(i.end.getMinutes()),descripcion:a.extendedProps.description,index:a.extendedProps.index,id:i.id};v(c)},Z=async()=>{console.log(m.id,"id");let e=await N.deleteEvent({token:d,idEvento:m.id});console.log(e),await p(d)},O=()=>{i(!e)},T=()=>{l(!a)};return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(o.W2,{fluid:!0,children:[(0,c.jsx)("div",{className:"row pt-3",children:(0,c.jsx)(t.Z,{plugins:[r.Z,s.ZP],initialView:"dayGridMonth",customButtons:{addEventButton:{text:"Nuevo",click(){i(!0)}},deleteEventButton:{text:"Borrar",click(){y()}},editEventButton:{text:"Editar",click(){E()}}},headerToolbar:{left:"prev,next today",center:"title",right:"addEventButton editEventButton deleteEventButton"},events:u,eventClick:w,displayEventEnd:!0,eventDisplay:"block"})}),(0,c.jsx)(f,{show:e,toggle:O,submit:g}),(0,c.jsx)(I,{show:a,toggle:T,submit:F,event:m})]})})};var y=E}},function(e){e.O(0,[69,141,455,865,774,888,179],function(){return e(e.s=1442)}),_N_E=e.O()}]);